# ==============================================
# SFA-Routing: Environment Configuration Template
# ==============================================
# Скопируйте в .env и настройте под ваше окружение
# cp .env.example .env && nano .env
#
# ВНИМАНИЕ: Никогда не коммитьте .env с реальными данными!
# ==============================================

# ==============================================
# БАЗОВЫЕ НАСТРОЙКИ
# ==============================================
APP_NAME=Route Optimization Service
APP_VERSION=1.1.0

# Окружение: development | staging | production
ENVIRONMENT=development

# Режим отладки (ВСЕГДА false в production!)
DEBUG=true

# Уровень логирования: DEBUG | INFO | WARNING | ERROR
LOG_LEVEL=INFO

# ==============================================
# БАЗА ДАННЫХ (PostgreSQL + PostGIS)
# ==============================================
# Формат: postgresql+asyncpg://user:password@host:port/database
DATABASE_URL=postgresql+asyncpg://routeuser:routepass@db:5432/routes

# Docker Compose переменные
POSTGRES_USER=routeuser
POSTGRES_PASSWORD=routepass
POSTGRES_DB=routes

# Настройки пула соединений
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=40
DATABASE_POOL_RECYCLE=1800

# ==============================================
# REDIS (Кэш и очереди)
# ==============================================
REDIS_URL=redis://redis:6379

# TTL для разных типов кэша (секунды)
CACHE_TTL_DISTANCE_MATRIX=604800
CACHE_TTL_CLIENT_LIST=3600
CACHE_TTL_AGENT_LOCATION=60
CACHE_TTL_GPS_POSITION=10

# ==============================================
# ВНЕШНИЕ СЕРВИСЫ
# ==============================================
# OSRM (матрицы расстояний)
OSRM_URL=http://osrm:5000

# VROOM (VRP солвер)
VROOM_URL=http://vroom:3000

# ==============================================
# БЕЗОПАСНОСТЬ
# ==============================================
# Секретный ключ для JWT (ОБЯЗАТЕЛЬНО ИЗМЕНИТЕ!)
# Генерация: python3 -c "import secrets; print(secrets.token_urlsafe(64))"
SECRET_KEY=your-super-secret-key-at-least-64-characters-generate-new-one-for-production

# JWT настройки
ACCESS_TOKEN_EXPIRE_MINUTES=60
REFRESH_TOKEN_EXPIRE_DAYS=7
ALGORITHM=HS256

# ==============================================
# RATE LIMITING
# ==============================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_DEFAULT_PER_MINUTE=60
RATE_LIMIT_WINDOW_SECONDS=60

# API тиры (requests per minute / max points / monthly quota)
API_CLIENT_DEFAULT_TIER=standard
API_CLIENT_FREE_RATE_LIMIT=10
API_CLIENT_FREE_MAX_POINTS=50
API_CLIENT_FREE_MONTHLY_QUOTA=1000
API_CLIENT_STANDARD_RATE_LIMIT=60
API_CLIENT_STANDARD_MAX_POINTS=200
API_CLIENT_STANDARD_MONTHLY_QUOTA=10000
API_CLIENT_PREMIUM_RATE_LIMIT=300
API_CLIENT_PREMIUM_MAX_POINTS=1000
API_CLIENT_PREMIUM_MONTHLY_QUOTA=100000

# ==============================================
# CORS (Cross-Origin Resource Sharing)
# ==============================================
# JSON список разрешённых доменов (без trailing slash!)
CORS_ORIGINS=["http://localhost:3000","http://localhost:3001","http://localhost:8080"]

# ==============================================
# CELERY (Фоновые задачи)
# ==============================================
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/1
CELERY_TASK_ALWAYS_EAGER=false

# ==============================================
# OBSERVABILITY (Опционально)
# ==============================================
# Prometheus метрики
METRICS_ENABLED=true
METRICS_PATH=/metrics

# Sentry (error tracking)
# Получите DSN на https://sentry.io
# SENTRY_DSN=https://your-key@sentry.io/project-id
# SENTRY_ENVIRONMENT=development
# SENTRY_TRACES_SAMPLE_RATE=0.1

# ==============================================
# ERP ИНТЕГРАЦИЯ (Опционально)
# ==============================================
# SmartUp ERP
# SMARTUP_API_URL=https://erp.yourcompany.com/api
# SMARTUP_API_TOKEN=your-erp-api-token

# ==============================================
# SOLVER CONFIGURATION
# ==============================================
# Предпочитаемый солвер: auto | vroom | ortools | genetic | greedy
SOLVER_DEFAULT=auto

# Генетический алгоритм
GA_POPULATION_SIZE=100
GA_GENERATIONS=500
GA_MUTATION_RATE=0.15
GA_ELITE_SIZE=5

# ==============================================
# GEO SECURITY (v1.1)
# ==============================================
# Ключ для шифрования координат (Fernet)
# Генерация: python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# GEO_ENCRYPTION_KEY=your-fernet-key-here

# Уровень анонимизации: none | low | medium | high
GEO_ANONYMIZATION_LEVEL=none

# ==============================================
# WEBSOCKET
# ==============================================
WS_HEARTBEAT_INTERVAL=30
WS_MAX_CONNECTIONS_PER_AGENT=5

# ==============================================
# ПРОВЕРОЧНЫЙ ЧЕКЛИСТ (для production)
# ==============================================
# [ ] ENVIRONMENT=production
# [ ] DEBUG=false
# [ ] POSTGRES_PASSWORD - уникальный сильный пароль (32+ символов)
# [ ] SECRET_KEY - сгенерирован заново (64+ символов)
# [ ] CORS_ORIGINS - реальные домены фронтенда
# [ ] SENTRY_DSN - настроен для отслеживания ошибок
# [ ] GEO_ENCRYPTION_KEY - сгенерирован (если используется)
